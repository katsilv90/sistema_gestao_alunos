<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestão de Unidades Curriculares</title>
    <link rel="stylesheet" th:href="@{/css/style.css}" />
    <link rel="stylesheet" th:href="@{/css/alunos.css}" />
</head>
<body>
<div class="container">

    <!-- Navbar -->
    <div th:replace="fragments/layout :: navbar"></div>

    <header class="header">
        <h1>Gestão de UCS</h1>
        <p>Sistema moderno para gerenciamento de Unidades Curriculares</p>
    </header>

    <!-- Formulário de cadastro -->
    <section class="section">
        <h2>Adicionar Nova UC</h2>
        <form th:action="@{/ucs}" th:object="${ucModel}" method="post">
            <input type="text" th:field="*{nome}" placeholder="Nome da UC" required class="form-input">

            <label for="curso">Curso:</label>
            <select id="curso" name="cursoId" required class="form-input">
                <option value="">Selecione um curso</option>
                <option th:each="curso : ${cursos}" th:value="${curso.id}" th:text="${curso.nome}"></option>
            </select>

            <button type="submit" class="btn btn-primary">Adicionar UC</button>
        </form>
    </section>

    <!-- Pesquisa -->
    <section class="section">
        <h2>Pesquisar UCs</h2>
        <form th:action="@{/ucs/pesquisar}" method="get">
            <input type="text" name="nome" placeholder="Digite o nome da UC"
                   th:value="${pesquisaUc.nome}" class="form-input">
            <button type="submit" class="btn btn-primary">Pesquisar</button>
        </form>

        <!-- Resultados da pesquisa -->
        <div th:if="${resultadosPesquisa != null}">
            <h3 th:if="${!resultadosPesquisa.isEmpty()}">Resultados da Pesquisa</h3>
            <h3 th:if="${resultadosPesquisa.isEmpty()}">Nenhuma UC encontrada</h3>

            <ul class="lista-ucs">
                <li th:each="uc : ${resultadosPesquisa}">
                    <strong th:text="${uc.id}"></strong> -
                    <span th:text="${uc.nome}"></span>
                    <span th:text="${#lists.isEmpty(uc.cursos) ? 'Sem curso' : uc.cursos.get(0).nome}"></span>
                </li>
            </ul>
        </div>
    </section>

    <!-- Lista completa -->
    <section class="section">
        <h2>Lista de UCs</h2>
        <ul class="lista-ucs" id="lista-ucs">
            <li class="item-aluno" th:each="uc : ${ucs}">
                <strong th:text="${uc.id}"></strong> -
                <span th:text="${uc.nome}"></span>
                <span th:text="${#lists.isEmpty(uc.cursos) ? 'Sem curso' : uc.cursos.get(0).nome}"></span>

                <button type="button"
                        class="btn-remover"
                        th:data-id="${uc.id}"
                        th:data-nome="${uc.nome}"
                        title="Remover UC">
                    Remover
                </button>
            </li>
        </ul>
    </section>

    <div th:replace="fragments/layout :: rodape"></div>
</div>

<!-- Toast -->
<div id="toast-data" th:data-mensagem="${toastMensagem}" th:data-tipo="${toastTipo}"></div>

<!-- Popup confirmação -->
<div id="popup-confirmacao" class="popup-overlay" style="display: none;">
    <div class="popup-box">
        <p id="popup-mensagem"></p>
        <div class="popup-botoes">
            <button id="btn-confirmar" class="btn btn-primary">Confirmar</button>
            <button id="btn-cancelar" class="btn">Cancelar</button>
        </div>
    </div>
</div>

<script th:src="@{/js/script.js}"></script>
</body>
</html>
